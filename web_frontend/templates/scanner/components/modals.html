<!-- Modal para Nova Varredura Avançada -->
<div class="modal fade" id="newScanModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-plus-circle me-2"></i>
                    Nova Varredura Avançada
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            
            <form id="advancedScanForm">
                <div class="modal-body">
                    <!-- Target Configuration -->
                    <div class="card mb-3">
                        <div class="card-header">
                            <h6 class="mb-0">
                                <i class="fas fa-crosshairs me-2"></i>
                                Configuração do Target
                            </h6>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="advancedTarget" class="form-label">Target *</label>
                                <input type="text" class="form-control" id="advancedTarget" required
                                       placeholder="192.168.1.0/24, 10.0.0.1, example.com">
                                <div class="form-text">
                                    Suporta: IP único, CIDR, hostname ou lista separada por vírgulas
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Port Configuration -->
                    <div class="card mb-3">
                        <div class="card-header">
                            <h6 class="mb-0">
                                <i class="fas fa-door-open me-2"></i>
                                Configuração de Portas
                            </h6>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="portOption" 
                                           id="customPorts" value="custom" checked>
                                    <label class="form-check-label" for="customPorts">Portas Personalizadas</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="portOption" 
                                           id="commonPorts" value="common">
                                    <label class="form-check-label" for="commonPorts">Portas Comuns</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="portOption" 
                                           id="top100Ports" value="top100">
                                    <label class="form-check-label" for="top100Ports">Top 100</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="portOption" 
                                           id="top1000Ports" value="top1000">
                                    <label class="form-check-label" for="top1000Ports">Top 1000</label>
                                </div>
                            </div>
                            
                            <div id="customPortsInput">
                                <label for="portsInput" class="form-label">Portas *</label>
                                <input type="text" class="form-control" id="portsInput" 
                                       placeholder="80,443,8080 ou 1-1000 ou 80,90-95,443">
                                <div class="form-text">
                                    Formatos aceitos: portas individuais (80,443), ranges (1-1000), ou mistos
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Protocol Configuration -->
                    <div class="card mb-3">
                        <div class="card-header">
                            <h6 class="mb-0">
                                <i class="fas fa-network-wired me-2"></i>
                                Protocolos
                            </h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="tcpProtocol" checked>
                                        <label class="form-check-label" for="tcpProtocol">
                                            <strong>TCP</strong>
                                            <small class="d-block text-muted">Transmission Control Protocol</small>
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="udpProtocol">
                                        <label class="form-check-label" for="udpProtocol">
                                            <strong>UDP</strong>
                                            <small class="d-block text-muted">User Datagram Protocol</small>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Advanced Settings -->
                    <div class="card">
                        <div class="card-header">
                            <h6 class="mb-0">
                                <i class="fas fa-sliders-h me-2"></i>
                                Configurações Avançadas
                            </h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <label for="timeoutSetting" class="form-label">
                                        Timeout (segundos)
                                        <i class="fas fa-info-circle" title="Tempo limite por conexão"></i>
                                    </label>
                                    <select class="form-select" id="timeoutSetting">
                                        <option value="1">1s (Rápido - Rede Local)</option>
                                        <option value="2">2s (Balanceado - Rede Local)</option>
                                        <option value="3" selected>3s (Padrão)</option>
                                        <option value="5">5s (Rede Externa)</option>
                                        <option value="10">10s (Rede Lenta/Stealth)</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="threadsSetting" class="form-label">
                                        Threads
                                        <i class="fas fa-info-circle" title="Número de conexões paralelas"></i>
                                    </label>
                                    <select class="form-select" id="threadsSetting">
                                        <option value="10">10 (Stealth)</option>
                                        <option value="25">25 (Conservador)</option>
                                        <option value="50" selected>50 (Padrão)</option>
                                        <option value="100">100 (Rápido)</option>
                                        <option value="200">200 (Agressivo)</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="mt-3">
                                <div class="alert alert-info">
                                    <i class="fas fa-lightbulb me-2"></i>
                                    <strong>Dica:</strong> Para redes locais, use timeout menor e mais threads. 
                                    Para redes externas ou stealth, use timeout maior e menos threads.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-play me-2"></i>
                        Iniciar Varredura
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Modal de Progresso -->
<div class="modal fade" id="progressModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-tasks me-2"></i>
                    Varredura em Progresso
                </h5>
            </div>
            <div class="modal-body text-center">
                <div class="network-animation mb-3">
                    <i class="fas fa-network-wired fa-3x text-primary"></i>
                </div>
                
                <div id="progressInfo">
                    <h6 id="progressTarget">Target: -</h6>
                    <p class="text-muted mb-3" id="progressStatus">Preparando varredura...</p>
                </div>
                
                <div class="progress mb-3" style="height: 25px;">
                    <div class="progress-bar progress-bar-striped progress-bar-animated" 
                         id="progressBar" style="width: 0%">0%</div>
                </div>
                
                <div class="row text-center">
                    <div class="col-4">
                        <small class="text-muted d-block">Verificadas</small>
                        <strong id="scannedCount">0</strong>
                    </div>
                    <div class="col-4">
                        <small class="text-muted d-block">Total</small>
                        <strong id="totalCount">0</strong>
                    </div>
                    <div class="col-4">
                        <small class="text-muted d-block">Abertas</small>
                        <strong id="openCount" class="text-success">0</strong>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" id="stopScanBtn">
                    <i class="fas fa-stop me-2"></i>
                    Parar Varredura
                </button>
                <button type="button" class="btn btn-success d-none" id="viewResultsBtn">
                    <i class="fas fa-eye me-2"></i>
                    Ver Resultados
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal de Ajuda -->
<div class="modal fade" id="helpModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-question-circle me-2"></i>
                    Ajuda - Port Scanner
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="accordion" id="helpAccordion">
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" 
                                    data-bs-target="#help-targets">
                                Configuração de Targets
                            </button>
                        </h2>
                        <div id="help-targets" class="accordion-collapse collapse show">
                            <div class="accordion-body">
                                <h6>Formatos Aceitos:</h6>
                                <ul>
                                    <li><code>192.168.1.1</code> - IP único</li>
                                    <li><code>192.168.1.0/24</code> - Range CIDR (256 IPs)</li>
                                    <li><code>example.com</code> - Hostname</li>
                                    <li><code>192.168.1.1,192.168.1.10,example.com</code> - Múltiplos targets</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" 
                                    data-bs-toggle="collapse" data-bs-target="#help-ports">
                                Configuração de Portas
                            </button>
                        </h2>
                        <div id="help-ports" class="accordion-collapse collapse">
                            <div class="accordion-body">
                                <h6>Opções:</h6>
                                <ul>
                                    <li><strong>Portas Comuns:</strong> 21,22,23,25,53,80,110,443,993,995...</li>
                                    <li><strong>Top 100:</strong> Portas 1-100 mais utilizadas</li>
                                    <li><strong>Top 1000:</strong> Portas 1-1000 mais utilizadas</li>
                                    <li><strong>Personalizadas:</strong> 80,443,8080 ou 1-1000 ou mistos</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" 
                                    data-bs-toggle="collapse" data-bs-target="#help-results">
                                Interpretação dos Resultados
                            </button>
                        </h2>
                        <div id="help-results" class="accordion-collapse collapse">
                            <div class="accordion-body">
                                <h6>Status das Portas:</h6>
                                <ul>
                                    <li><span class="status-open">OPEN:</span> Porta aberta e aceitando conexões</li>
                                    <li><span class="status-closed">CLOSED:</span> Porta fechada (resposta de recusa)</li>
                                    <li><span class="status-filtered">FILTERED:</span> Porta filtrada (firewall)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="alert alert-warning mt-3">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    <strong>Aviso Legal:</strong> Use esta ferramenta apenas em redes próprias 
                    ou com autorização explícita. O uso não autorizado pode violar leis locais.
                </div>
            </div>
        </div>
    </div>
</div>
